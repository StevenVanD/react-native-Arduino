{"version":3,"file":"index.cjs.js","sources":["../src/index.js"],"sourcesContent":["import fs from \"fs\"\nimport path from \"path\"\nimport appRoot from \"app-root-dir\"\n\nconst dotEnvBase = path.join(appRoot.get(), \".env\")\n\nif (!process.env.NODE_ENV) {\n  // Default to development as most solutions seems to implement.\n  // By explicitely setting it if not configured we are able to pass it\n  // to e.g. Webpack for compilation\n  process.env.NODE_ENV = \"development\"\n}\n\n// Cache Node environment at load time. We have to do it to make\n// sure that the serialization, which might happen later, is in sync\n// with the parsing of the conditional NODE_ENV files now.\nconst NODE_ENV = process.env.NODE_ENV\n\n// Either \"client\" or \"server\"\nconst BUILD_TARGET = process.env.BUILD_TARGET\n\n// https://github.com/bkeepers/dotenv#what-other-env-files-can-i-use\n// Don't include `.env.local` for `test` environment\n// since normally you expect tests to produce the same\n// results for everyone\nconst dotenvFiles = [\n  BUILD_TARGET && `${dotEnvBase}.${BUILD_TARGET}.${NODE_ENV}.local`,\n  BUILD_TARGET && `${dotEnvBase}.${BUILD_TARGET}.${NODE_ENV}`,\n  BUILD_TARGET && NODE_ENV !== \"test\" && `${dotEnvBase}.${BUILD_TARGET}.local`,\n  BUILD_TARGET && `${dotEnvBase}.${BUILD_TARGET}`,\n  `${dotEnvBase}.${NODE_ENV}.local`,\n  `${dotEnvBase}.${NODE_ENV}`,\n  NODE_ENV !== \"test\" && `${dotEnvBase}.local`,\n  dotEnvBase\n].filter(Boolean)\n\n// Load environment variables from .env* files. Suppress warnings using silent\n// if this file is missing. dotenv will never modify any environment variables\n// that have already been set. Variable expansion is supported in .env files.\n// https://github.com/motdotla/dotenv\n// https://github.com/motdotla/dotenv-expand\ndotenvFiles.forEach((dotenvFile) => {\n  if (fs.existsSync(dotenvFile)) {\n    require(\"dotenv-expand\")(\n      require(\"dotenv\").config({\n        path: dotenvFile\n      })\n    )\n  }\n})\n\nif (process.env.APP_ROOT == null) {\n  process.env.APP_ROOT = appRoot.get()\n}\n\nif (process.env.APP_SOURCE == null) {\n  const sourceFolder = path.join(process.env.APP_ROOT, \"src\")\n  process.env.APP_SOURCE = fs.existsSync(sourceFolder) ? sourceFolder : process.env.APP_ROOT\n}\n\n// Grab NODE_ENV and REACT_APP_* environment variables and prepare them to be\n// injected into the application via DefinePlugin in Webpack configuration.\nconst APP_SPECIFIC_ENV = /^APP_/i\n\nexport function getEnvironment() {\n  const raw = {}\n  Object.keys(process.env)\n    .filter((key) => APP_SPECIFIC_ENV.test(key))\n    .forEach((key) => {\n      raw[key] = process.env[key]\n    })\n\n  // Add core settings to raw data - which is not prefixed at all\n  raw.NODE_ENV = NODE_ENV\n\n  if (BUILD_TARGET) {\n    raw.BUILD_TARGET = BUILD_TARGET\n  }\n\n  // Add hint about root and source folders\n  raw.APP_ROOT = process.env.APP_ROOT\n  raw.APP_SOURCE = process.env.APP_SOURCE\n\n  // Stringify all values so we can feed into Webpack DefinePlugin\n  const stringified = {}\n  const webpack = { \"process.env\": stringified }\n  Object.keys(raw).forEach((key) => {\n    stringified[key] = JSON.stringify(raw[key])\n  })\n\n  return { raw, stringified, webpack }\n}\n"],"names":["dotEnvBase","path","join","appRoot","get","process","env","NODE_ENV","BUILD_TARGET","dotenvFiles","filter","Boolean","forEach","dotenvFile","fs","existsSync","require","config","APP_ROOT","APP_SOURCE","sourceFolder","APP_SPECIFIC_ENV","getEnvironment","raw","keys","key","test","stringified","JSON","stringify"],"mappings":";;;;;;;;;;;;;;;;AAIA,IAAMA,aAAaC,KAAKC,IAAL,CAAUC,QAAQC,GAAR,EAAV,EAAyB,MAAzB,CAAnB;;AAEA,IAAI,CAACC,QAAQC,GAAR,CAAYC,QAAjB,EAA2B;UAIjBD,GAAR,CAAYC,QAAZ,GAAuB,aAAvB;;;IAMIA,WAAWF,QAAQC,GAAR,CAAYC;IAGvBC,eAAeH,QAAQC,GAAR,CAAYE;IAM3BC,cAAc,CAClBD,gBAAmBR,UAAnB,SAAiCQ,YAAjC,SAAiDD,QAAjD,WADkB,EAElBC,gBAAmBR,UAAnB,SAAiCQ,YAAjC,SAAiDD,QAF/B,EAGlBC,gBAAgBD,aAAa,MAA7B,IAA0CP,UAA1C,SAAwDQ,YAAxD,WAHkB,EAIlBA,gBAAmBR,UAAnB,SAAiCQ,YAJf,EAKfR,UALe,SAKDO,QALC,aAMfP,UANe,SAMDO,QANC,EAOlBA,aAAa,MAAb,IAA0BP,UAA1B,WAPkB,EAQlBA,UARkB,EASlBU,MATkB,CASXC,OATW;AAgBpBF,YAAYG,OAAZ,CAAoB,UAACC,UAAD,EAAgB;MAC9BC,GAAGC,UAAH,CAAcF,UAAd,CAAJ,EAA+B;YACrB,eAAR,EACEG,QAAQ,QAAR,EAAkBC,MAAlB,CAAyB;YACjBJ;KADR,CADF;;CAFJ;;AAUA,IAAIR,QAAQC,GAAR,CAAYY,QAAZ,IAAwB,IAA5B,EAAkC;UACxBZ,GAAR,CAAYY,QAAZ,GAAuBf,QAAQC,GAAR,EAAvB;;;AAGF,IAAIC,QAAQC,GAAR,CAAYa,UAAZ,IAA0B,IAA9B,EAAoC;MAC5BC,eAAenB,KAAKC,IAAL,CAAUG,QAAQC,GAAR,CAAYY,QAAtB,EAAgC,KAAhC,CAArB;UACQZ,GAAR,CAAYa,UAAZ,GAAyBL,GAAGC,UAAH,CAAcK,YAAd,IAA8BA,YAA9B,GAA6Cf,QAAQC,GAAR,CAAYY,QAAlF;;;AAKF,IAAMG,mBAAmB,QAAzB;AAEA,AAAO,SAASC,cAAT,GAA0B;MACzBC,MAAM,EAAZ;SACOC,IAAP,CAAYnB,QAAQC,GAApB,EACGI,MADH,CACU,UAACe,GAAD;WAASJ,iBAAiBK,IAAjB,CAAsBD,GAAtB,CAAT;GADV,EAEGb,OAFH,CAEW,UAACa,GAAD,EAAS;QACZA,GAAJ,IAAWpB,QAAQC,GAAR,CAAYmB,GAAZ,CAAX;GAHJ;MAOIlB,QAAJ,GAAeA,QAAf;;MAEIC,YAAJ,EAAkB;QACZA,YAAJ,GAAmBA,YAAnB;;;MAIEU,QAAJ,GAAeb,QAAQC,GAAR,CAAYY,QAA3B;MACIC,UAAJ,GAAiBd,QAAQC,GAAR,CAAYa,UAA7B;MAGMQ,cAAc,EApBW;SAsBxBH,IAAP,CAAYD,GAAZ,EAAiBX,OAAjB,CAAyB,UAACa,GAAD,EAAS;gBACpBA,GAAZ,IAAmBG,KAAKC,SAAL,CAAeN,IAAIE,GAAJ,CAAf,CAAnB;GADF;SAIO;YAAA;4BAAA;aALS;qBAAiBE;;GAKjC;;;;;"}